<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <script src="https://code.jquery.com/jquery-1.6.4.js"></script>
    <title>情報表示モニター</title>
  </head>
  <body>
    <div id="attend1">
      <img src="出席1.png">
    </div>
    <div id="attend2">
      <img src="離席.png">
    </div>
    <div id="eew">
      <img src="eew.png">
    </div>
    <div id="tsunami1">
      <img src="津波1.png">
    </div>
    <div id="tsunami2">
      <img src="津波2.png">
    </div>
    <div id="quake">
      <img src="地震1.png">
    </div>
    <div id="tsunamiNotifycation">
      <img src="津波1(通知).png">
    </div>
    <div id="error">
      <img src="不具合1.png">
    </div>
    <script>
      window.setInterval(check, 500);
      var attend,eew,tsunami,quake,tsunamiNotify,error = "";
      error = false
      check(){
        try{
          var url = 'https://script.google.com/macros/s/AKfycbyD8llwZGIAZ8Dqvs7uv0LgHjDR45oCj95OvP8LLzLCkg0JEeXWElrS9ex7GutPlB70/exec';
          fetch(url)
            .then(response => response.json())
            .then(data => {
              if(attend !== data.attend){
                attend = data.attend;
                if(data.attend === "Yes"){
                  document.getElementById("attend1").style.display = "block"
                  document.getElementById("attend2").style.display = "none"
                  document.getElementById("eew").style.display = "none"
                  document.getElementById("tsunami1").style.display = "none"
                  document.getElementById("tsunami2").style.display = "none"
                  document.getElementById("quake").style.display = "none"
                  document.getElementById("tsunamiNotifycation").style.display = "none"
                  document.getElementById("error").style.display = "none"
                }else if(data.attend === "No"){
                  document.getElementById("attend1").style.display = "none"
                  document.getElementById("attend2").style.display = "block"
                  document.getElementById("eew").style.display = "none"
                  document.getElementById("tsunami1").style.display = "none"
                  document.getElementById("tsunami2").style.display = "none"
                  document.getElementById("quake").style.display = "none"
                  document.getElementById("tsunamiNotifycation").style.display = "none"
                  document.getElementById("error").style.display = "none"
                }else{
                  throw expression;
                }
              }
            });
          url = 'https://api.p2pquake.net/v2/history?codes=556';
          fetch(url)
            .then(response => response.json())
            .then(data => {
              if(eew !== data.id){
                eew = data.id;
                document.getElementById("attend1").style.display = "none"
                document.getElementById("attend2").style.display = "none"
                document.getElementById("eew").style.display = "block"
                document.getElementById("tsunami1").style.display = "none"
                document.getElementById("tsunami2").style.display = "none"
                document.getElementById("quake").style.display = "none"
                document.getElementById("tsunamiNotifycation").style.display = "none"
                document.getElementById("error").style.display = "none"
              }
            });
          url = 'https://api.p2pquake.net/v2/history?codes=556';
          fetch(url)
            .then(response => response.json())
            .then(data => {
              if(tsunami !== data.id){
                tsunami = data.id;
                document.getElementById("attend1").style.display = "none"
                document.getElementById("attend2").style.display = "none"
                document.getElementById("eew").style.display = "block"
                document.getElementById("tsunami1").style.display = "none"
                document.getElementById("tsunami2").style.display = "none"
                document.getElementById("quake").style.display = "none"
                document.getElementById("tsunamiNotifycation").style.display = "none"
                document.getElementById("error").style.display = "none"
              }
            });
        }catch(e){
          document.getElementById("attend1").style.display = "none"
          document.getElementById("attend2").style.display = "none"
          document.getElementById("eew").style.display = "none"
          document.getElementById("tsunami1").style.display = "none"
          document.getElementById("tsunami2").style.display = "none"
          document.getElementById("quake").style.display = "none"
          document.getElementById("tsunamiNotifycation").style.display = "none"
          document.getElementById("error").style.display = "block"
        }
      }
    </script>
  </body>
</html>
